# HashMap的结构

## 1.7中的HashMap结构

1.7中的结构为**数组加链表**的结构。

![[Pasted image 20210714160122.png]]

### 1.7中扩容的环形队列问题

1.7的HashMap中的entry的插入方式为**头插入**，在扩容过程中重新计算元素所在数组的位置过程中，可能会出现循环队列的问题。

未扩容前：
![[Pasted image 20210714161735.png]]

扩容重新计算位置后：
![[Pasted image 20210714161823.png]]

几个线程都调整完成，就可能出现环形链表
![[Pasted image 20210714161900.png]]

在1.8之后HashMap采用了尾插入方式，避免了循环链表的问题。


## 1.8中的HashMap结构
1.8中的结构为**数组加链表或者是树**的结构。

![[Pasted image 20210714160340.png]]

## HashMap中线程不安全的问题

