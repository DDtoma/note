## 索引的本质
一种高效读取数据的排好序的数据结构，MySQL使用B+树来存储这些数据。

## 索引的数据结构

### 红黑树
红黑树是一般树的一种优化，一般树存在一个问题。在特殊的情况下可能会退化成链表，即所有的叶子节点都在树的同一侧。红黑树使用自旋的方式做平衡，使节点两侧高度不大于1。单红黑树也存在问题，即树的高度不可控。树的高度可能会非常深，搜索的效率下降。

### B树与B+树
B树与B+树，是红黑树的改良，单节点内存放多元素，使节点的高度可控。

> B树
![[Pasted image 20210315094005.png]]

> B+树
![[Pasted image 20210315094112.png]]


B+树是对B树的一种优化，B+树的是将所有的的数据都放在的末端的叶子节点当中。上层的节点数据都可以加载到内存中快速搜索，并且占用内存小。MySQL中一个节点的默认大小为16kb。

MySQL中查看节点大小：
`SHOW GLOBAL STATUS LIKE 'Innodb_page_size'`

## 存储引擎
MySQL中的存储引擎作用于数据库中的表，而不是库，即表的类型不同。
myisam和innodb都是以B+树作为底层数据结构进行存储。

### myisam

> myisam表存储结构 （非聚集、离散索引）
![[Pasted image 20210315190848.png]]

所有的叶子节点存储的是具体数据的位置，而不是具体的数值。

### innodb

> innodb表存储结构 （集聚索引）
![[Pasted image 20210315191231.png]]

所有叶子节点包含了完整的数据记录，而不是数据地址。

### 联合索引

联合索引是一个有序的数据结构，从字段的第一个开始。在查询的时候必须从索引字段的第一个开始。

> 联合索引结构
![[Pasted image 20210315192713.png]]

建立一个关于`name, age, position`的联合索引，在查询的时候`where`条件必须从`name`开始，这个就是最左前缀发展。